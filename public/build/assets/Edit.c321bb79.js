import{u as L,r as s,R as e,H as U,L as F,d as B}from"./app.4042e15c.js";import{L as R}from"./Account.02056a37.js";import{S as G}from"./sweetalert2.all.ec62c549.js";import"./Dropdown.d6b0e181.js";function Q(){const{errors:m,provinces:o,cities:i,pengajuan:t}=L().props,[k,H]=s.exports.useState(t.user_id),[v,x]=s.exports.useState(t.name),[g,D]=s.exports.useState(t.kta),[r,_]=s.exports.useState(t.province_id),[h,j]=s.exports.useState(t.city_id),[P,y]=s.exports.useState(t.tgl_mutasi),[w,C]=s.exports.useState(t.keterangan),[c,u]=s.exports.useState(t.tujuan_mutasi),[f,p]=s.exports.useState(t.dpc_mutasi),[T,S]=s.exports.useState(null),[n,E]=s.exports.useState(t.tipe_pindah||""),[A,d]=s.exports.useState([]);s.exports.useEffect(()=>{if(t.tipe_pindah)E(t.tipe_pindah);else{const a=c==r;E(a?"dpc":"dpw")}if(t.tipe_pindah==="dpw"&&c){const a=i.filter(l=>l.province_id==c);d(a)}else if(t.tipe_pindah==="dpc"){const a=i.filter(l=>l.province_id==r);d(a)}},[t,c,r,i]);const W=a=>{const l=a.target.value;E(l),l==="dpc"?(u(r),d(i.filter(b=>b.province_id==r))):(u(""),d([])),p("")},M=a=>{const l=a.target.value;if(u(l),l){const b=i.filter(q=>q.province_id==l);d(b)}else d([]);p("")},I=async a=>{a.preventDefault();const l={user_id:k,name:v,kta:g,province_id:r,city_id:h,tgl_mutasi:P,keterangan:w,tipe_pindah:n,document:T,_method:"PUT"};n==="dpw"?(l.tujuan_mutasi=c,l.dpc_mutasi=f):n==="dpc"&&(l.tujuan_mutasi=r,l.dpc_mutasi=f),B.Inertia.post(`/account/pengajuan/${t.id}`,l,{onSuccess:()=>{G.fire({title:"Success!",text:"Data Pengajuan Anda Berhasil di Update!",icon:"success",showConfirmButton:!1,timer:2500})}})},N=()=>{const a=o.find(l=>l.id==r);return a?a.name:"DPW Asal"},K=()=>{const a=o.find(l=>l.id==c);return a?a.name:"DPW Tujuan"};return e.createElement(e.Fragment,null,e.createElement(U,null,e.createElement("title",null,"Edit Pengajuan - IKATWI")),e.createElement(R,null,e.createElement("div",{className:"col-md-12 mt-2"},e.createElement("div",{className:"card border-0 shadow-sm"},e.createElement("div",{className:"card-header bg-primary text-white"},e.createElement("h5",{className:"card-title mb-0"},e.createElement("i",{className:"fas fa-edit me-2"}),"Edit Pengajuan Mutasi")),e.createElement("div",{className:"card-body"},e.createElement("form",{onSubmit:I},e.createElement("div",{className:"row mb-4"},e.createElement("div",{className:"col-12"},e.createElement("h6",{className:"text-primary mb-3 border-bottom pb-2"},e.createElement("i",{className:"fas fa-user me-2"}),"Data Diri")),e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Nama Lengkap"),e.createElement("input",{type:"text",className:"form-control bg-light",value:v,onChange:a=>x(a.target.value),disabled:!0}))),e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Nomor KTA"),e.createElement("input",{type:"text",className:"form-control bg-light",value:g,onChange:a=>D(a.target.value),disabled:!0})))),e.createElement("div",{className:"row mb-4"},e.createElement("div",{className:"col-12"},e.createElement("h6",{className:"text-primary mb-3 border-bottom pb-2"},e.createElement("i",{className:"fas fa-map-marker-alt me-2"}),"Asal Keanggotaan")),e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"DPW Asal"),e.createElement("select",{className:"form-select bg-light",disabled:!0,value:r,onChange:a=>_(a.target.value)},e.createElement("option",{value:""},"-- Pilih DPW --"),o.map(a=>e.createElement("option",{value:a.id,key:a.id},a.name))))),e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"DPC Asal"),e.createElement("select",{className:"form-select bg-light",disabled:!0,value:h,onChange:a=>j(a.target.value)},e.createElement("option",{value:""},"-- Pilih DPC --"),i.map(a=>e.createElement("option",{value:a.id,key:a.id},a.name)))))),e.createElement("div",{className:"row mb-4"},e.createElement("div",{className:"col-12"},e.createElement("h6",{className:"text-primary mb-3 border-bottom pb-2"},e.createElement("i",{className:"fas fa-file-alt me-2"}),"Data Mutasi")),e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Tipe Pindah ",e.createElement("span",{className:"text-danger"},"*")),e.createElement("select",{className:"form-select",value:n,onChange:W,required:!0},e.createElement("option",{value:""},"-- Pilih Tipe Pindah --"),e.createElement("option",{value:"dpw"},"Pindah DPW (Pindah Provinsi)"),e.createElement("option",{value:"dpc"},"Pindah DPC (Pindah Kabupaten/Kota dalam Provinsi yang sama)")),m.tipe_pindah&&e.createElement("div",{className:"alert alert-danger mt-2"},m.tipe_pindah))),e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Tanggal Mutasi ",e.createElement("span",{className:"text-danger"},"*")),e.createElement("input",{type:"date",className:"form-control",value:P,onChange:a=>y(a.target.value),placeholder:"Pilih Tanggal Mutasi",required:!0}),m.tgl_mutasi&&e.createElement("div",{className:"alert alert-danger mt-2"},m.tgl_mutasi)))),e.createElement("div",{className:"row mb-4"},e.createElement("div",{className:"col-12"},e.createElement("h6",{className:"text-primary mb-3 border-bottom pb-2"},e.createElement("i",{className:"fas fa-file-pdf me-2"}),"Document Mutasi")),e.createElement("div",{className:"col-12"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Upload Document Mutasi"),e.createElement("input",{type:"file",className:"form-control",onChange:a=>S(a.target.files[0]),accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),e.createElement("div",{className:"form-text"},"Upload document pendukung mutasi (PDF, DOC, JPG, PNG). Max 2MB.",t.document&&e.createElement("span",{className:"text-success ms-2"},e.createElement("i",{className:"fas fa-check me-1"}),"Document sudah diupload: ",t.document)),m.document&&e.createElement("div",{className:"alert alert-danger mt-2"},m.document)))),e.createElement("div",{className:"row mb-4"},e.createElement("div",{className:"col-12"},e.createElement("h6",{className:"text-primary mb-3 border-bottom pb-2"},e.createElement("i",{className:"fas fa-location-arrow me-2"}),"Tujuan Mutasi")),(n==="dpw"||n==="dpc")&&e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},n==="dpw"?"Tujuan DPW":"DPW"," ",e.createElement("span",{className:"text-danger"},"*")),n==="dpw"?e.createElement("select",{className:"form-select",value:c,onChange:M,required:!0},e.createElement("option",{value:""},"-- Pilih Tujuan DPW --"),o.map(a=>e.createElement("option",{value:a.id,key:a.id},a.name))):e.createElement("input",{type:"text",className:"form-control bg-light",value:N(),disabled:!0}),m.tujuan_mutasi&&e.createElement("div",{className:"alert alert-danger mt-2"},m.tujuan_mutasi))),(n==="dpw"||n==="dpc")&&e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Tujuan DPC ",e.createElement("span",{className:"text-danger"},"*")),e.createElement("select",{className:"form-select",value:f,onChange:a=>p(a.target.value),required:!0,disabled:n==="dpw"&&!c},e.createElement("option",{value:""},n==="dpw"&&!c?"-- Pilih DPW terlebih dahulu --":"-- Pilih Tujuan DPC --"),A.map(a=>e.createElement("option",{value:a.id,key:a.id},a.name))),n==="dpw"&&!c&&e.createElement("div",{className:"form-text text-warning"},"Pilih DPW tujuan terlebih dahulu untuk melihat DPC yang tersedia"),m.dpc_mutasi&&e.createElement("div",{className:"alert alert-danger mt-2"},m.dpc_mutasi))),n==="dpc"&&e.createElement("div",{className:"col-12"},e.createElement("div",{className:"alert alert-info"},e.createElement("i",{className:"fas fa-info-circle me-2"}),e.createElement("strong",null,"Informasi:")," Anda melakukan mutasi DPC dalam Provinsi ",e.createElement("strong",null,N()),". Tujuan DPW akan tetap di ",e.createElement("strong",null,N()),".")),n==="dpw"&&c&&e.createElement("div",{className:"col-12"},e.createElement("div",{className:"alert alert-info"},e.createElement("i",{className:"fas fa-info-circle me-2"}),e.createElement("strong",null,"Informasi:")," Anda melakukan mutasi ke Provinsi ",e.createElement("strong",null,K()),". Pilih DPC tujuan di provinsi tersebut.")),e.createElement("div",{className:"col-12"},e.createElement("div",{className:"alert alert-light border mt-2"},e.createElement("small",null,e.createElement("i",{className:"fas fa-info-circle me-2"}),n==="dpw"?"Pindah DPW: Anda akan pindah ke provinsi lain. Pilih tujuan DPW dan DPC.":n==="dpc"?"Pindah DPC: Anda akan pindah ke kabupaten/kota lain dalam provinsi yang sama.":"Pilih tipe pindah terlebih dahulu.")))),e.createElement("div",{className:"row mb-4"},e.createElement("div",{className:"col-12"},e.createElement("h6",{className:"text-primary mb-3 border-bottom pb-2"},e.createElement("i",{className:"fas fa-sticky-note me-2"}),"Keterangan")),e.createElement("div",{className:"col-12"},e.createElement("div",{className:"mb-3"},e.createElement("label",{className:"form-label fw-bold"},"Alasan Mutasi ",e.createElement("span",{className:"text-danger"},"*")),e.createElement("textarea",{className:"form-control",rows:"4",value:w,onChange:a=>C(a.target.value),placeholder:"Contoh: Mutasi karena pindah tempat kerja, pindah domisili, atau alasan lainnya...",required:!0}),e.createElement("div",{className:"form-text"},"Jelaskan alasan Anda melakukan mutasi dengan jelas."),m.keterangan&&e.createElement("div",{className:"alert alert-danger mt-2"},m.keterangan)))),e.createElement("div",{className:"row mb-4"},e.createElement("div",{className:"col-12"},e.createElement("div",{className:"card border-warning"},e.createElement("div",{className:"card-body"},e.createElement("div",{className:"form-check"},e.createElement("input",{className:"form-check-input",type:"checkbox",required:!0,id:"confirmationCheck"}),e.createElement("label",{className:"form-check-label fw-bold text-warning",htmlFor:"confirmationCheck"},e.createElement("i",{className:"fas fa-exclamation-triangle me-2"}),"Saya menyatakan bahwa data yang saya inputkan adalah benar dan sesuai. Saya bertanggung jawab penuh atas kebenaran data mutasi ini.")))))),e.createElement("div",{className:"row mt-4"},e.createElement("div",{className:"col-12"},e.createElement("div",{className:"d-flex gap-2 justify-content-end"},e.createElement(F,{href:"/account/pengajuan",className:"btn btn-secondary"},e.createElement("i",{className:"fas fa-arrow-left me-2"}),"Kembali"),e.createElement("button",{type:"reset",className:"btn btn-warning",onClick:()=>{if(E(t.tipe_pindah||""),u(t.tujuan_mutasi),p(t.dpc_mutasi),t.tipe_pindah==="dpw"&&t.tujuan_mutasi){const a=i.filter(l=>l.province_id==t.tujuan_mutasi);d(a)}else if(t.tipe_pindah==="dpc"){const a=i.filter(l=>l.province_id==r);d(a)}}},e.createElement("i",{className:"fas fa-redo me-2"}),"Reset"),e.createElement("button",{type:"submit",className:"btn btn-success"},e.createElement("i",{className:"fas fa-save me-2"}),"Update Pengajuan"))))))))))}export{Q as default};
