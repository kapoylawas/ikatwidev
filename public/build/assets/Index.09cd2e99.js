import{r,R as e,H as I}from"./app.c264c37d.js";import{L as T}from"./Web.c1e2f5dc.js";import{a as W}from"./index.36a313a4.js";import"./Dropdown.f657d3fc.js";import"./index.249e753f.js";function _({provinces:p,cities:d}){var v,y;const[i,o]=r.exports.useState([]),[x,g]=r.exports.useState(!1),[s,f]=r.exports.useState(""),[c,u]=r.exports.useState(""),[m,h]=r.exports.useState(""),[b,E]=r.exports.useState(d),k=new Date;r.exports.useEffect(()=>{if(s){const a=d.filter(t=>t.province_id==s);E(a)}else E(d);u("")},[s,d]);const N=(a,t,n)=>{g(!0),o([]),W.post("/searchAnggota",{q:a,dpc:t,dpw:n}).then(l=>{console.log("data",l),g(!1),o(l.data.anggota.data)})},w=a=>{const t=a.target.value;h(t),N(t,c,s)},P=a=>{const t=a.target.value;f(t),N(m,c,t)},S=a=>{const t=a.target.value;u(t),N(m,t,s)},C=()=>{h(""),f(""),u(""),o([]),E(d)},D=a=>a.length===0?[{status:"Belum Bayar",isPaid:!1,tahun:null}]:a.sort((n,l)=>l.tahun-n.tahun).map(n=>({status:n.status,isPaid:!0,tahun:n.tahun}));return e.createElement(e.Fragment,null,e.createElement(I,null,e.createElement("title",null,"IKATWI - Daftar Anggota")),e.createElement(T,null,e.createElement("div",{className:"container",style:{marginTop:"100px",marginBottom:"50px"}},e.createElement("div",{className:"fade-in"},e.createElement("div",{className:"row justify-content-center"},e.createElement("div",{className:"col-md-8"},e.createElement("div",{className:"text-center mb-4"},e.createElement("h4",{className:"font-weight-bold text-primary mb-2"},e.createElement("i",{className:"fas fa-users me-2"}),"Daftar Anggota IKATWI"),e.createElement("p",{className:"text-muted"},"Temukan informasi anggota Ikatan Terapis Wicara Indonesia")),e.createElement("div",{className:"card border-0 rounded shadow-sm mb-4"},e.createElement("div",{className:"card-body p-3"},e.createElement("div",{className:"row g-2"},e.createElement("div",{className:"col-md-12 mb-2"},e.createElement("div",{className:"input-group"},e.createElement("span",{className:"input-group-text bg-light border-end-0"},e.createElement("i",{className:"fas fa-search text-muted"})),e.createElement("input",{type:"text",className:"form-control border-start-0",value:m,onChange:w,placeholder:"Cari berdasarkan nama atau nomor anggota..."}))),e.createElement("div",{className:"col-md-6"},e.createElement("select",{className:"form-select",onChange:P,value:s},e.createElement("option",{value:""},"Semua DPW"),p.map(a=>e.createElement("option",{key:a.id,value:a.id},a.name)))),e.createElement("div",{className:"col-md-6"},e.createElement("select",{className:"form-select",onChange:S,value:c,disabled:!s&&b.length===0},e.createElement("option",{value:""},"Semua DPC"),b.map(a=>e.createElement("option",{key:a.id,value:a.id},a.name))),!s&&e.createElement("small",{className:"text-muted"},"Pilih DPW terlebih dahulu untuk melihat DPC"))),e.createElement("div",{className:"row mt-2"},e.createElement("div",{className:"col-12"},e.createElement("button",{onClick:C,className:"btn btn-outline-secondary btn-sm"},e.createElement("i",{className:"fas fa-times me-1"}),"Hapus Filter"))))),i.length>0&&e.createElement("div",{className:"alert alert-info mb-3 py-2"},e.createElement("i",{className:"fas fa-info-circle me-2"}),"Menampilkan ",i.length," anggota",(s||c||m)&&e.createElement("span",null," ","dengan filter:",s&&` DPW: ${(v=p.find(a=>a.id==s))==null?void 0:v.name}`,c&&` DPC: ${(y=d.find(a=>a.id==c))==null?void 0:y.name}`,m&&` Pencarian: "${m}"`)),e.createElement("div",{className:"card border-0 rounded shadow-sm"},e.createElement("div",{className:"card-header bg-primary text-white py-2"},e.createElement("h5",{className:"mb-0"},e.createElement("i",{className:"fas fa-list me-2"}),"Data Anggota")),e.createElement("div",{className:"card-body p-0"},x?e.createElement("div",{className:"text-center py-4"},e.createElement("div",{className:"spinner-border text-primary mb-2",role:"status"},e.createElement("span",{className:"visually-hidden"},"Loading...")),e.createElement("p",{className:"text-muted"},"Memuat data anggota...")):i.length>0?e.createElement("div",{className:"table-responsive"},e.createElement("table",{className:"table table-bordered table-striped table-hovered mb-0"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",{scope:"col",style:{width:"3%"}},"No"),e.createElement("th",{scope:"col",style:{width:"8%"}},"Foto"),e.createElement("th",{scope:"col",style:{width:"10%"}},"No Anggota"),e.createElement("th",{scope:"col",style:{width:"15%"}},"Nama"),e.createElement("th",{scope:"col",style:{width:"15%"}},"DPW"),e.createElement("th",{scope:"col",style:{width:"15%"}},"DPC"),e.createElement("th",{scope:"col",style:{width:"14%"}},"Status SIP"),e.createElement("th",{scope:"col",style:{width:"10%"}},"Status Iuran"))),e.createElement("tbody",null,i.map((a,t)=>{const n=D(a.transaction);return e.createElement("tr",{key:t,className:"align-middle"},e.createElement("td",{className:"text-center"},t+1),e.createElement("td",{className:"text-center"},e.createElement("img",{src:a.image,className:"rounded-3",width:"50",alt:a.name,onError:l=>{l.target.onerror=null,l.target.src="/assets/images/user.png"}})),e.createElement("td",null,e.createElement("span",{className:"fw-bold text-dark"},a.no_anggota)),e.createElement("td",{className:"fw-semibold text-dark"},a.name),e.createElement("td",null,a.province.name),e.createElement("td",null,a.city===0?e.createElement("span",{className:"text-muted"},"DPC tidak ada"):a.city.name),e.createElement("td",null,new Date(a.surat_sip.map(l=>l.date_end))>=k?e.createElement("span",{className:"badge bg-success"},e.createElement("i",{className:"fas fa-check-circle me-1"}),"Aktif"):e.createElement("span",{className:"badge bg-danger"},e.createElement("i",{className:"fas fa-times-circle me-1"}),"Non Aktif")),e.createElement("td",null,n[0].isPaid?e.createElement("div",{className:"d-flex flex-wrap gap-1 justify-content-center"},n.map((l,A)=>e.createElement("span",{key:A,className:"badge bg-success",title:`Tahun ${l.tahun}`},e.createElement("i",{className:"fas fa-check me-1"}),l.tahun))):e.createElement("span",{className:"badge bg-warning text-dark"},e.createElement("i",{className:"fas fa-exclamation-triangle me-1"}),"Belum Bayar")))})))):e.createElement("div",{className:"text-center py-4"},e.createElement("i",{className:"fas fa-users fa-2x text-muted mb-2"}),e.createElement("h6",{className:"text-muted"},"Tidak ada data anggota"),e.createElement("p",{className:"text-muted small"},m||s||c?"Coba ubah kata kunci atau filter pencarian":"Gunakan form pencarian di atas untuk menemukan anggota")))),e.createElement("div",{className:"row mt-3 mb-5"},e.createElement("div",{className:"col-md-12"},e.createElement("div",{className:"card border-0 bg-light rounded"},e.createElement("div",{className:"card-body py-2"},e.createElement("h6",{className:"mb-2"},e.createElement("i",{className:"fas fa-info-circle me-2 text-primary"}),"Keterangan Status:"),e.createElement("div",{className:"row"},e.createElement("div",{className:"col-md-4 mb-1"},e.createElement("span",{className:"badge bg-success me-1"},e.createElement("i",{className:"fas fa-check"})),e.createElement("small",{className:"fw-semibold"},"Lunas (Tahun)")),e.createElement("div",{className:"col-md-4 mb-1"},e.createElement("span",{className:"badge bg-danger me-1"},e.createElement("i",{className:"fas fa-times"})),e.createElement("small",{className:"fw-semibold"},"Non Aktif SIP")),e.createElement("div",{className:"col-md-4 mb-1"},e.createElement("span",{className:"badge bg-warning text-dark me-1"},e.createElement("i",{className:"fas fa-exclamation"})),e.createElement("small",{className:"fw-semibold"},"Belum Bayar"))),e.createElement("div",{className:"row mt-1"},e.createElement("div",{className:"col-12"},e.createElement("small",{className:"text-muted"},e.createElement("i",null,"Angka pada badge hijau menunjukkan tahun iuran yang sudah dibayar"))))))))))))))}export{_ as default};
