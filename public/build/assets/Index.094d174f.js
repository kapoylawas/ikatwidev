import{r,R as e,H as I}from"./app.df0172cd.js";import{L as T}from"./Web.4d6fb4b1.js";import{a as F}from"./index.4fdc9b6f.js";import"./Dropdown.da0dda9f.js";import"./index.249e753f.js";function _({provinces:g,cities:d}){var v,y;const[o,i]=r.exports.useState([]),[x,N]=r.exports.useState(!1),[l,h]=r.exports.useState(""),[m,u]=r.exports.useState(""),[c,b]=r.exports.useState(""),[f,E]=r.exports.useState(d),k=new Date;r.exports.useEffect(()=>{if(l){const t=d.filter(a=>a.province_id==l);E(t)}else E(d);u("")},[l,d]);const p=(t,a,n)=>{N(!0),i([]),F.post("/searchAnggota",{q:t,dpc:a,dpw:n}).then(s=>{console.log("data",s),N(!1),i(s.data.anggota.data)})},w=t=>{const a=t.target.value;b(a),p(a,m,l)},P=t=>{const a=t.target.value;h(a),p(c,m,a)},C=t=>{const a=t.target.value;u(a),p(c,a,l)},S=()=>{b(""),h(""),u(""),i([]),E(d)},D=t=>t.length===0?[{status:"Belum Bayar",isPaid:!1,tahun:null}]:t.sort((n,s)=>s.tahun-n.tahun).map(n=>({status:n.status,isPaid:!0,tahun:n.tahun}));return e.createElement(e.Fragment,null,e.createElement(I,null,e.createElement("title",null,"IKATWI - Daftar Anggota")),e.createElement(T,null,e.createElement("div",{className:"container",style:{marginTop:"100px",marginBottom:"50px"}},e.createElement("div",{className:"fade-in"},e.createElement("div",{className:"row justify-content-center"},e.createElement("div",{className:"col-md-8"},e.createElement("div",{className:"text-center mb-4"},e.createElement("h4",{className:"font-weight-bold text-primary mb-2"},e.createElement("i",{className:"fas fa-users me-2"}),"Daftar Anggota IKATWI"),e.createElement("p",{className:"text-muted"},"Temukan informasi anggota Ikatan Terapis Wicara Indonesia")),e.createElement("div",{className:"card border-0 rounded shadow-sm mb-4"},e.createElement("div",{className:"card-body p-3"},e.createElement("div",{className:"row g-2"},e.createElement("div",{className:"col-md-12 mb-2"},e.createElement("div",{className:"input-group"},e.createElement("span",{className:"input-group-text bg-light border-end-0"},e.createElement("i",{className:"fas fa-search text-muted"})),e.createElement("input",{type:"text",className:"form-control border-start-0",value:c,onChange:w,placeholder:"Cari berdasarkan nama atau nomor anggota..."}))),e.createElement("div",{className:"col-md-6"},e.createElement("select",{className:"form-select",onChange:P,value:l},e.createElement("option",{value:""},"Semua DPW"),g.map(t=>e.createElement("option",{key:t.id,value:t.id},t.name)))),e.createElement("div",{className:"col-md-6"},e.createElement("select",{className:"form-select",onChange:C,value:m,disabled:!l&&f.length===0},e.createElement("option",{value:""},"Semua DPC"),f.map(t=>e.createElement("option",{key:t.id,value:t.id},t.name))),!l&&e.createElement("small",{className:"text-muted"},"Pilih DPW terlebih dahulu untuk melihat DPC"))),e.createElement("div",{className:"row mt-2"},e.createElement("div",{className:"col-12"},e.createElement("button",{onClick:S,className:"btn btn-outline-secondary btn-sm"},e.createElement("i",{className:"fas fa-times me-1"}),"Hapus Filter"))))),o.length>0&&e.createElement("div",{className:"alert alert-info mb-3 py-2"},e.createElement("i",{className:"fas fa-info-circle me-2"}),"Menampilkan ",o.length," anggota",(l||m||c)&&e.createElement("span",null," ","dengan filter:",l&&` DPW: ${(v=g.find(t=>t.id==l))==null?void 0:v.name}`,m&&` DPC: ${(y=d.find(t=>t.id==m))==null?void 0:y.name}`,c&&` Pencarian: "${c}"`)),e.createElement("div",{className:"card border-0 rounded shadow-sm"},e.createElement("div",{className:"card-header bg-primary text-white py-2"},e.createElement("h5",{className:"mb-0"},e.createElement("i",{className:"fas fa-list me-2"}),"Data Anggota")),e.createElement("div",{className:"card-body p-0"},x?e.createElement("div",{className:"text-center py-4"},e.createElement("div",{className:"spinner-border text-primary mb-2",role:"status"},e.createElement("span",{className:"visually-hidden"},"Loading...")),e.createElement("p",{className:"text-muted"},"Memuat data anggota...")):o.length>0?e.createElement("div",{className:"table-responsive"},e.createElement("table",{className:"table table-bordered table-striped table-hovered mb-0"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",{scope:"col",style:{width:"3%"}},"No"),e.createElement("th",{scope:"col",style:{width:"8%"}},"Foto"),e.createElement("th",{scope:"col",style:{width:"10%"}},"No Anggota"),e.createElement("th",{scope:"col",style:{width:"15%"}},"Nama"),e.createElement("th",{scope:"col",style:{width:"15%"}},"DPW"),e.createElement("th",{scope:"col",style:{width:"15%"}},"DPC"),e.createElement("th",{scope:"col",style:{width:"14%"}},"Status SIP"),e.createElement("th",{scope:"col",style:{width:"10%"}},"Status Iuran"))),e.createElement("tbody",null,o.map((t,a)=>{const n=D(t.transaction);return e.createElement("tr",{key:a,className:"align-middle"},e.createElement("td",{className:"text-center"},a+1),e.createElement("td",{className:"text-center"},e.createElement("img",{src:t.image,className:"rounded-3",width:"50",alt:t.name,onError:s=>{s.target.onerror=null,s.target.src="/assets/images/user.png"}})),e.createElement("td",null,e.createElement("span",{className:"fw-bold text-dark"},t.no_anggota)),e.createElement("td",{className:"fw-semibold text-dark"},t.name),e.createElement("td",null,t.province.name),e.createElement("td",null,t.city===0?e.createElement("span",{className:"text-muted"},"DPC tidak ada"):t.city.name),e.createElement("td",null,new Date(t.surat_sip.map(s=>s.date_end))>=k?e.createElement("span",{className:"badge bg-success"},"Aktif"):e.createElement("span",{className:"badge bg-danger"},"Non Aktif")),e.createElement("td",null,n[0].isPaid?e.createElement("div",{className:"d-flex flex-wrap gap-1 justify-content-center"},n.map((s,A)=>e.createElement("span",{key:A,className:"badge bg-success",title:`Tahun ${s.tahun}`},s.tahun))):e.createElement("span",{className:"badge bg-warning text-dark"},"Belum Bayar")))})))):e.createElement("div",{className:"text-center py-4"},e.createElement("i",{className:"fas fa-users fa-2x text-muted mb-2"}),e.createElement("h6",{className:"text-muted"},"Tidak ada data anggota"),e.createElement("p",{className:"text-muted small"},c||l||m?"Coba ubah kata kunci atau filter pencarian":"Gunakan form pencarian di atas untuk menemukan anggota")))),e.createElement("div",{className:"row mt-3 mb-4"},e.createElement("div",{className:"col-md-12"},e.createElement("div",{className:"card border-0 bg-light rounded"},e.createElement("div",{className:"card-body py-2"},e.createElement("h6",{className:"mb-2"},e.createElement("i",{className:"fas fa-info-circle me-2 text-primary"}),"Keterangan Status:"),e.createElement("div",{className:"row"},e.createElement("div",{className:"col-md-3 mb-1"},e.createElement("span",{className:"badge bg-success me-1"},"\u25CF"),e.createElement("small",null,"Lunas (Tahun)")),e.createElement("div",{className:"col-md-3 mb-1"},e.createElement("span",{className:"badge bg-danger me-1"},"\u25CF"),e.createElement("small",null,"Non Aktif SIP")),e.createElement("div",{className:"col-md-3 mb-1"},e.createElement("span",{className:"badge bg-warning text-dark me-1"},"\u25CF"),e.createElement("small",null,"Belum Bayar"))),e.createElement("div",{className:"row mt-1"},e.createElement("div",{className:"col-12"},e.createElement("small",{className:"text-muted"},e.createElement("i",null,"Angka pada badge hijau menunjukkan tahun iuran yang sudah dibayar"))))))))))))))}export{_ as default};
